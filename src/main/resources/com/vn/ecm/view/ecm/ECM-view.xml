<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://ecmView.title">
    <data>
        <collection id="foldersDc" class="com.vn.ecm.entity.Folder">
            <fetchPlan>
                <property name="name"/>
                <property name="parent"/>
            </fetchPlan>
            <loader id="foldersDl">
                <query>
                    <![CDATA[select f from Folder f]]>
                </query>
            </loader>

        </collection>


        <collection id="filesDc" class="com.vn.ecm.entity.FileDescriptor">
            <fetchPlan>
                <property name="name"/>
                <property name="extension"/>
                <property name="size"/>
                <property name="lastModified"/>
                <property name="folder"/>
            </fetchPlan>
            <loader id="filesDl">
                <query><![CDATA[
                         select f from FileDescriptor f
                         where (:folderId is null or f.folder.id = :folderId)
                         order by f.name]]>
                </query>

            </loader>
        </collection>


    </data>

    <layout>
        <split width="100%" height="100%">
            <!--left-->
            <vbox width="100%" height="100%">
                <treeDataGrid id="foldersTree"
                              dataContainer="foldersDc"
                              hierarchyProperty="parent"
                              width="100%"
                              minHeight="100%">
                    <columns>
                        <column property="name" header="Name"/>

                    </columns>
                    <actions>
                        <action id="createFolder" text="New Folder"/>
                        <action id="create" text="New Bucket"/>
                        <action id="delete" text="Delete"/>
                        <action id="assignPermission" text="Assign Permission"/>
                    </actions>
                </treeDataGrid>
            </vbox>

            <!--right-->
            <vbox width="100%" height="100%">
                <upload id="upload"
                        dropAllowed="true"
                        receiverType="MULTI_FILE_TEMPORARY_STORAGE_BUFFER"/>
                <dataGrid id="fileDataGird"
                          width="100%"
                          minHeight="20em"
                          dataContainer="filesDc">

                    <actions>
                        <action id="onObjectAssignPermission" text="Assign Permission"/>
                    </actions>

                    <columns>
                        <column property="name" header="Name"/>
                        <column property="size" header="Size"/>
                        <column property="extension" header="Extension"/>
                        <column property="lastModified" header="Modified"/>
                    </columns>
                </dataGrid>
            </vbox>

        </split>

    </layout>
</view>